function drawChart(){var t=20,a=40,e=30,r=40,o=650-r-a,i=350-t-e,n=2e3;var c=d3.select("#chart").append("svg").attr("width",o+r+a).attr("height",i+t+e).call((function(t){const a=d3.select(t.node().parentNode),e=parseInt(t.style("width"),10),r=parseInt(t.style("height"),10),o=e/r;function i(){const e=parseInt(a.style("width"));t.attr("width",e),t.attr("height",Math.round(e/o))}t.attr("viewBox",`0 0 ${e} ${r}`).attr("preserveAspectRatio","xMinYMid").call(i),d3.select(window).on("resize."+a.attr("id"),i)})).append("g").attr("transform",`translate(${r}, ${t})`),s=[{x:1965,y:.25},{x:1967,y:.4},{x:1968,y:.32},{x:1970,y:.55},{x:1973,y:.43},{x:1974,y:.45},{x:1975,y:.65},{x:1976,y:.68},{x:1979,y:.99},{x:1980,y:.97},{x:1983,y:1.25},{x:1984,y:1.2},{x:1985,y:1.34},{x:1986,y:1.31},{x:1987,y:1.57},{x:1988,y:1.52},{x:1989,y:1.78},{x:1992,y:1.55},{x:1993,y:1.72},{x:1994,y:2.2},{x:1995,y:1.99},{x:1997,y:2.3},{x:1998,y:2.8},{x:1999,y:3.8},{x:2001,y:3.6},{x:2003,y:3.76},{x:2004,y:3.82},{x:2005,y:3.5},{x:2006,y:3.9},{x:2007,y:4.2},{x:2008,y:4.17},{x:2009,y:4.24},{x:2011,y:4.85},{x:2012,y:5.25},{x:2014,y:5.75},{x:2015,y:6.2},{x:2017,y:6.4},{x:2019,y:6.28},{x:2020,y:6.8}],l=[1970,1979,1986,1994,1999,2005,2012,2019],d=s.filter((t=>l.includes(t.x))),y=d3.scaleLinear().domain([1965,2020]).range([0,o]),p=d3.axisBottom(y).ticks(9).tickFormat(((t,a)=>0!==a?`'${t.toString().split("").slice(2).join("")}`:"")).tickPadding(15).tickSizeInner(-i);c.append("g").attr("transform","translate(0,"+i+")").call(p);var u=d3.scaleLinear().domain([0,7]).range([i,0]),x=d3.axisLeft(u);x.ticks(9).tickPadding(10).tickFormat(((t,a)=>0!==a?`$${t}M`:`${t}`)).tickSizeInner(-o),c.append("g").call(x);let g=d3.line().x((t=>y(t[0]))).y((t=>u(t[1])));c.append("path").attr({d:g(s),class:"lineChart"});c.append("path").datum(s).attr("fill","url(#gradient)").attr("stroke","none").attr("fill-opacity",0).transition().delay(n).duration(2500).attr("fill-opacity",.3).attr("d",d3.area().x((function(t){return y(t.x)})).y0(i).y1((function(t){return u(t.y)}))),c.append("defs"),c.call((t=>{const a=t.select("defs").append("linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");a.append("stop").attr("offset","0%").attr("style","stop-color:#2028E833;"),a.append("stop").attr("offset","100%").attr("style","stop-color:#2028E8bb;")}));let f=c.append("path").datum(s).attr("fill","none").attr("stroke-width",2).attr("d",d3.line().x((function(t){return y(t.x)})).y((function(t){return u(t.y)})));var m=f.node().getTotalLength();f.attr("stroke-dasharray",m+" "+m).attr("stroke-dashoffset",m).attr("stroke","skyblue").transition().delay(1e3).duration(2e3).ease(d3.easeCircleIn).attr("stroke","#3D35F1").attr("stroke-dashoffset",0),c.selectAll("w").data(d).enter().append("circle").attr("fill","#3D35F1").attr("stroke","white").attr("cy",i).attr("cx",(function(t){return y(t.x)})).attr("r",10).attr("opacity",0).attr("stroke-width",0).attr("fill","#3D35F1").transition().delay(n).delay(((t,a)=>120*a+1e3)).duration(2e3).ease(d3.easeElasticOut).attr("cx",(function(t){return y(t.x)})).attr("cy",(function(t){return u(t.y)})).attr("r",3).attr("stroke-width",2.3).attr("fill","white").attr("stroke","#3D35F1").attr("opacity",1)}const observer=new IntersectionObserver(((t,a)=>{t.forEach((t=>{t.isIntersecting&&(drawChart(),a.unobserve(t.target))}))}),{threshold:.2}),target=document.querySelector("#chart-container");observer.observe(target),gsap.registerPlugin(ScrollTrigger);const mapTl=gsap.timeline({scrollTrigger:{trigger:"#map-container",start:"top 100%",end:"top 15%"}}).fromTo("#map-container",{opacity:0,filter:"saturate(0%)"},{opacity:1,filter:"saturate(120%)",duration:2,ease:"pow3.Out"}).from("#map-image",{scale:1.3,rotate:60,opacity:0,duration:1.2,ease:"Expo.inOut(2)"},"<").from("#san-francisco-city-map",{opacity:0,filter:"grayscale(1)",duration:.4,ease:"circ.Out()"},"<50%").from("#san-francisco-pin",{scale:2,opacity:0,duration:.4,ease:"circ.out(2)"},"<50%").from("#map-container-center",{scale:2,opacity:0,duration:.4,ease:"circ.out(2)"},"<50%").from(".map-location-label",{scale:0,opacity:0,duration:.4,stagger:-.5,ease:"back.out(2)"},"<").from(".map-container-circle",{opacity:0,scale:.5,duration:.8,stagger:-.2,ease:"back.out(2)"},"<").from(".broadcast-label",{scale:2,opacity:0,duration:.8,stagger:-.5,ease:"back.out(2)"},"<25%").from(".broadcast-label > div",{xPercent:0,scale:0,opacity:0,duration:.3,stagger:-.5,ease:"circ.out()"},"<10%");gsap.from("#walton-circle-image",{scrollTrigger:{trigger:"#walton-circle-image",start:"-100px 100%"},opacity:0,xPercent:50,duration:1.7,ease:"quad.inOut"});const bubble=document.querySelector(".bubble-container"),megaTl=gsap.timeline({scrollTrigger:{trigger:"#mass_media_circle",start:"40% 100%"}}).from("#megaphone",{rotate:60,opacity:0,scale:0,x:350,y:300,duration:1,ease:"back.out(1.7)"}).fromTo(bubble,{opacity:0,scale:0,rotate:20,x:200,y:100},{opacity:1,scale:1,x:0,y:0,rotate:-2,duration:.8,ease:"back.out(3)"},"<75%").from(bubble.querySelector("p"),{filter:"blur(4px)",scale:1.1,opacity:0,duration:.5,ease:"circ.out"});